// This script wraps int, float, and string into Puppy classes.
// It is recommended to use these for basic types if references to them is required.
#ifnset STD_TYPE_WRAP
#set STD_TYPE_WRAP

#include std/std.puppy
#include std/tpjudge.puppy
#define STD_TYPE_WRAP_LIB = type_wrap

enter std:
    map STD_TYPE_WRAP_LIB:
        proc __initialize_failure:
            param tp val
            throw "Instance of " (repr_of tp) " initialization failed with argument " (repr_of val) "."
        proc __set_failure:
            param tp val
            throw "Setting value for instance of " (repr_of tp) " failed with argument " (repr_of val) "."
        
        use &tpjudge

        class Int:
            attr val
            
            spec func init:
                param val
                if &tpjudge.is_int val:
                    self.val = val
                else:
                    &__initialize_failure &Int val
            
            func set:
                param val
                if &tpjudge.is_int val:
                    self.val = val
                else:
                    &__set_failure &Int val

        class Float:
            attr val
            
            spec func init:
                param val
                if &tpjudge.is_float val:
                    self.val = val
                else:
                    &__initialize_failure &Float val
            
            func set:
                param val
                if &tpjudge.is_float val:
                    self.val = val
                else:
                    &__set_failure &Float val

        class String:
            attr val
            
            spec func init:
                param val
                if &tpjudge.is_str val:
                    self.val = val
                else:
                    &__initialize_failure &String val
            
            func set:
                param val
                if &tpjudge.is_str val:
                    self.val = val
                else:
                    &__set_failure &String val

#ifnset STD_NO_ALIAS
    use STD_TYPE_WRAP_LIB.Int
    use STD_TYPE_WRAP_LIB.Float
    use STD_TYPE_WRAP_LIB.String
#end

#end
